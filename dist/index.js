(()=>{"use strict";var e,t;class n{}n.getStorage=e=>new Promise((t=>{chrome.storage.sync.get([e],(n=>{t(n[e]?JSON.parse(n[e]):null)}))})),n.setStorage=(e,t)=>{return n=void 0,o=void 0,s=function*(){return chrome.storage.sync.set({[e]:JSON.stringify(t)})},new((r=void 0)||(r=Promise))((function(e,t){function i(e){try{c(s.next(e))}catch(e){t(e)}}function a(e){try{c(s.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(i,a)}c((s=s.apply(n,o||[])).next())}));var n,o,r,s};class o{constructor(){this.isEnabled={autoSkip:!1},this.url={autoSkipHandler:""},this.initPlayerNodeObserver=()=>new MutationObserver((()=>{var e;this.isEnabled.autoSkip&&(null===(e=document.querySelector('[data-testid="video-overlay"]'))||void 0===e||e.querySelectorAll("button").forEach((e=>{"다음 수업보기"===e.innerText&&e.click()})))})),this.setPlayerNodeObserver=()=>{const e=document.querySelector("video");if(!e)return;const t=e.parentElement;this.playerNodeObserver.observe(t,{childList:!0})},this.autoSkipHandler=({id:e,isEnabled:t,url:o})=>(this.url.autoSkipHandler!==o&&(this.url.autoSkipHandler=o,this.playerNodeObserver&&this.playerNodeObserver.disconnect(),setTimeout((()=>{this.setPlayerNodeObserver()}),500)),n.setStorage(e,t),this.isEnabled.autoSkip=t,{isEnabled:this.isEnabled.autoSkip}),this.speedHandler=({isUp:e,videoEle:t})=>{let n=t.playbackRate;if(n=.25*Math.floor(n/.25),e){const e=n+.25>5?5:n+.25;return t.playbackRate=e,{playbackRate:e}}const o=n-.25<.5?.5:n-.25;return t.playbackRate=o,{playbackRate:o}},this.playerNodeObserver=this.initPlayerNodeObserver()}}e=o,o.getInstance=()=>(e.instance||(e.instance=new o),e.instance);class r{constructor(){this.searchMyCourse=e=>{if(0===e.length)return;const t=encodeURI(`https://www.inflearn.com/my-courses?s=${e}`);window.location.href=t}}}t=r,r.getInstance=()=>(t.instance||(t.instance=new r),t.instance);var s,i=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{c(o.next(e))}catch(e){s(e)}}function a(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}c((o=o.apply(e,t||[])).next())}))};class a{constructor(e){this.courseService=e,this.initAutoSkip=({button:e,isEnabled:t,url:n})=>{const o=e.getAttribute("id");try{const r=this.courseService.autoSkipHandler({id:o,isEnabled:t,url:n});this.setAutoSkipStyle({button:e,isEnabled:r.isEnabled})}catch(e){console.warn(e)}},this.setAutoSkipStyle=({button:e,isEnabled:t})=>{t?(e.style.color="white",e.style.backgroundColor="rgb(0, 196, 113)",e.innerText="자동 재생중",e.setAttribute("data-button","true")):(e.style.color="rgb(0, 196, 113)",e.style.backgroundColor="transparent",e.innerText="자동 재생",e.setAttribute("data-button","false"))},this.autoSkipHandler=({button:e})=>i(this,void 0,void 0,(function*(){const t=e.getAttribute("id"),n="false"!==e.getAttribute("data-button");try{const o=this.courseService.autoSkipHandler({id:t,isEnabled:!n});this.setAutoSkipStyle({button:e,isEnabled:o.isEnabled})}catch(e){console.warn(e)}})),this.setSpeedDiv=({controller:e,playbackRate:t})=>{const n=e.querySelector("div");n&&(n.innerText=t.toString()+"X")},this.speedHandler=({isUp:e,controller:t})=>i(this,void 0,void 0,(function*(){try{const n=document.querySelector("video");if(!n)return;const o=this.courseService.speedHandler({isUp:e,videoEle:n});this.setSpeedDiv({controller:t,playbackRate:o.playbackRate?o.playbackRate:1})}catch(e){console.warn(e)}}))}}s=a,a.getInstance=e=>(s.instance||(s.instance=new a(e)),s.instance);var c,l,u=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{c(o.next(e))}catch(e){s(e)}}function a(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}c((o=o.apply(e,t||[])).next())}))};class d{constructor(e){this.courseController=e,this.button={autoSkip:!1},this.createAutoSkipButton=()=>{},this.autoSkip=e=>u(this,void 0,void 0,(function*(){const t="inflearn-extra-course-auto_skip";let o=yield n.getStorage(t);null===o&&(n.setStorage(t,!1),o=!1);const r=document.querySelector(`#${t}`);if(r)return void this.courseController.initAutoSkip({button:r,isEnabled:o,url:e});if(this.button.autoSkip)return;const s=document.createElement("button");s.id=t,s.type="button",s.style.height="36px",s.style.marginLeft="8px",s.style.fontSize="14px",s.style.border="none",s.style.fontWeight="500",s.style.borderRadius="8px",s.style.border="1px solid rgb(0, 196, 113)",s.style.padding="0px 5px",s.style.fontFamily='retendard, -apple-system, BlinkMacSystemFont, system-ui, Roboto, "Helvetica Neue", "Segoe UI", "Apple SD Gothic Neo", "Noto Sans KR", "Malgun Gothic", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", sans-seri',s.style.width="100px",this.courseController.initAutoSkip({button:s,isEnabled:o,url:e}),s.addEventListener("click",(()=>{this.courseController.autoSkipHandler({button:s})})),document.querySelector(".mantine-Group-root").prepend(s),this.button.autoSkip=!0})),this.videoSpeed=()=>u(this,void 0,void 0,(function*(){const e="inflearn-extra-course-video_speed";if(document.querySelector(`#${e}`))return void setTimeout((()=>{const e=document.querySelector("video");i.innerText=void 0===(null==e?void 0:e.playbackRate)?"1X":(null==e?void 0:e.playbackRate)+"X"}),500);const t=document.createElement("div");t.id=e,t.setAttribute("data-speed","1"),t.style.display="flex",t.style.height="36px",t.style.color="white",t.style.alignItems="center",t.style.justifyContent="center",t.style.fontSize="15px",t.style.border="1px solid rgb(0, 196, 113)",t.style.padding="0px 0px",t.style.borderRadius="8px",t.style.fontFamily='retendard, -apple-system, BlinkMacSystemFont, system-ui, Roboto, "Helvetica Neue", "Segoe UI", "Apple SD Gothic Neo", "Noto Sans KR", "Malgun Gothic", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", sans-seri';const n=document.createElement("button");n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">\n\t\t<path stroke-linecap="round" stroke-linejoin="round" d="M4.5 15.75l7.5-7.5 7.5 7.5" />\n\t</svg>',n.style.backgroundColor="transparent",n.style.border="none",n.style.padding="3px",n.style.display="flex",n.style.justifyContent="center",n.style.alignItems="center";const o=n.querySelector("svg");o.style.height="25px",o.style.fill="transparent",o.style.stroke="rgb(0, 196, 113)";const r=document.createElement("button");r.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">\n\t\t<path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />\n\t</svg>\n\t',r.style.backgroundColor="transparent",r.style.border="none",r.style.padding="3px",r.style.display="flex",r.style.justifyContent="center",r.style.alignItems="center";const s=r.querySelector("svg");s.style.height="25px",s.style.fill="transparent",s.style.stroke="rgb(0, 196, 113)";const i=document.createElement("div");i.style.width="35px",i.style.textAlign="center",n.addEventListener("click",(()=>{this.courseController.speedHandler({isUp:!0,controller:t})})),r.addEventListener("click",(()=>{this.courseController.speedHandler({isUp:!1,controller:t})})),t.appendChild(r),t.appendChild(i),t.appendChild(n),setTimeout((()=>{const e=document.querySelector("video");i.innerText=void 0===(null==e?void 0:e.playbackRate)?"1X":(null==e?void 0:e.playbackRate)+"X"}),500),document.querySelector(".mantine-Group-root").prepend(t)}))}}c=d,d.getInstance=e=>(c.instance||(c.instance=new d(e)),c.instance);class h{constructor(e){this.homeService=e,this.searchMyCourse=({searchDiv:e})=>{try{const t=e.querySelector("input").value;this.homeService.searchMyCourse(t)}catch(e){console.warn(e)}}}}l=h,h.getInstance=e=>(l.instance||(l.instance=new h(e)),l.instance);var y;class p{constructor(e){this.homeController=e,this.searchMyCourse=()=>{return e=this,t=void 0,o=function*(){const e="inflearn-extra-home-search_my_course";if(document.querySelector(`#${e}`))return;const t=document.createElement("div");t.id=e,t.className="search search_bar navbar-item header_search",t.innerHTML='\n    <label class="visually-hidden" for="searchbar-input">내 강의 검색</label>\n    <input type="text" id="mycourse-searchbar-input" enterkeyhint="go" class="input" placeholder="내 강의 검색" data-kv="headerSearchWord">\n    <div class="search__icon e-header-search"><i class="far fa-search"></i></div>\n  ';const n=t.querySelector("input");n.style.backgroundColor="rgb(216, 255, 239)",document.querySelector(".navbar-right").prepend(t),document.querySelector("div").addEventListener("click",(()=>{this.homeController.searchMyCourse({searchDiv:t})})),n.addEventListener("keydown",(e=>{"Enter"===e.key&&this.homeController.searchMyCourse({searchDiv:t})}))},new((n=void 0)||(n=Promise))((function(r,s){function i(e){try{c(o.next(e))}catch(e){s(e)}}function a(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}c((o=o.apply(e,t||[])).next())}));var e,t,n,o}}}y=p,p.getInstance=e=>(y.instance||(y.instance=new p(e)),y.instance);chrome.runtime.onMessage.addListener(((e,t,n)=>{return s=void 0,i=void 0,l=function*(){const t=new URL(e.url);if(document.querySelector("#searchbar-input")){const e=p.getInstance(h.getInstance(r.getInstance()));yield e.searchMyCourse()}else if(t.pathname.includes("/course/lecture")){const t=d.getInstance(a.getInstance(o.getInstance()));yield t.autoSkip(e.url),yield t.videoSpeed()}},new((c=void 0)||(c=Promise))((function(e,t){function n(e){try{r(l.next(e))}catch(e){t(e)}}function o(e){try{r(l.throw(e))}catch(e){t(e)}}function r(t){var r;t.done?e(t.value):(r=t.value,r instanceof c?r:new c((function(e){e(r)}))).then(n,o)}r((l=l.apply(s,i||[])).next())}));var s,i,c,l}))})();