(()=>{"use strict";var t,n=function(t,n,e,i){return new(e||(e=Promise))((function(o,c){function s(t){try{u(i.next(t))}catch(t){c(t)}}function r(t){try{u(i.throw(t))}catch(t){c(t)}}function u(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(s,r)}u((i=i.apply(t,n||[])).next())}))};class e{constructor(){this.getStorage=t=>new Promise((n=>{chrome.storage.sync.get([t],(e=>{n(e[t]?JSON.parse(e[t]):null)}))})),this.setStorage=(t,e)=>n(this,void 0,void 0,(function*(){return chrome.storage.sync.set({[t]:JSON.stringify(e)})})),this.getConfig=()=>n(this,void 0,void 0,(function*(){return this.getStorage("inflearn-extra-config")})),this.setConfig=t=>n(this,void 0,void 0,(function*(){yield this.setStorage("inflearn-extra-config",t)}))}}t=e,e.getInstance=()=>(t.instance||(t.instance=new e),t.instance);var i,o=function(t,n,e,i){return new(e||(e=Promise))((function(o,c){function s(t){try{u(i.next(t))}catch(t){c(t)}}function r(t){try{u(i.throw(t))}catch(t){c(t)}}function u(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(s,r)}u((i=i.apply(t,n||[])).next())}))};class c{constructor(t){this.configRepo=t,this.config={},this.isInit=!1,this.init=()=>o(this,void 0,void 0,(function*(){if(this.isInit)return;this.disableRestrictedMenu();const t=yield this.configRepo.getConfig(),n=document.querySelectorAll("li");for(const e of n){const n=e.querySelector("span");if(n){const t=n.getAttribute("data-i18n");n.innerText=chrome.i18n.getMessage(t)}const i=e.querySelector("input"),o=i.id;this.config[o]=null===t||t[o],[""].includes(o)&&(this.config[o]=!1),i.checked=this.config[o],i.addEventListener("click",(()=>{this.config[o]=!this.config[o],this.updateConfig()}))}this.configRepo.setConfig(this.config)})),this.disableRestrictedMenu=()=>{const t=document.querySelectorAll("section");t&&t.forEach(((t,n)=>{const e=t.querySelectorAll("li");let i=0;e.forEach(((n,e)=>{const o=n.querySelector("input");if(!o)return;const c=o.getAttribute("id");c&&([""].includes(c)&&(n.style.display="none",i++),i===e+1&&(t.style.display="none"))}))}))},this.updateConfig=()=>{const t=document.querySelectorAll("li input");for(const n of t){const t=n.id;this.config[t]=n.checked,[""].includes(t)&&(this.config[t]=!1),n.checked=this.config[t]}this.configRepo.setConfig(this.config)}}}i=c,c.getInstance=t=>(i.instance||(i.instance=new c(t)),i.instance),document.addEventListener("DOMContentLoaded",(()=>o(void 0,void 0,void 0,(function*(){(yield chrome.tabs.query({currentWindow:!0,active:!0}))[0],c.getInstance(e.getInstance()).init()}))))})();